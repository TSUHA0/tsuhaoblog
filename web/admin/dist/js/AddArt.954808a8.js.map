{"version":3,"sources":["webpack:///./src/components/article/AddArt.vue?6d35","webpack:///src/components/article/AddArt.vue","webpack:///./src/components/article/AddArt.vue?51f2","webpack:///./src/components/article/AddArt.vue","webpack:///./node_modules/core-js/modules/es.object.keys.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","Add","ref","attrs","artInfo","artInfoRules","model","value","callback","$$v","$set","expression","span","on","CateChange","_l","item","key","id","name","upUrl","headers","upChange","$imgAdd","staticClass","staticStyle","submitClk","staticRenderFns","data","title","cid","undefined","desc","content","img","CurrCateName","Catelist","token","mounted","getCateList","Object","keys","$route","params","indexOf","getArtInfo","methods","$refs","artInfoRef","validate","info","file","status","s","$message","error","response","message","success","url","component","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","target","stat","forced","it"],"mappings":"iHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGP,EAAIQ,IAAM,OAAS,WAAWJ,EAAG,SAAS,CAACA,EAAG,eAAe,CAACK,IAAI,aAAaC,MAAM,CAAC,MAAQV,EAAIW,QAAQ,MAAQX,EAAIY,eAAe,CAACR,EAAG,QAAQ,CAACM,MAAM,CAAC,OAAS,KAAK,CAACN,EAAG,QAAQ,CAACM,MAAM,CAAC,KAAO,KAAK,CAACN,EAAG,oBAAoB,CAACM,MAAM,CAAC,MAAQ,OAAO,KAAO,UAAU,CAACN,EAAG,UAAU,CAACS,MAAM,CAACC,MAAOd,EAAIW,QAAa,MAAEI,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIW,QAAS,QAASK,IAAME,WAAW,oBAAoB,IAAI,IAAI,GAAGd,EAAG,QAAQ,CAACM,MAAM,CAAC,OAAS,KAAK,CAACN,EAAG,QAAQ,CAACM,MAAM,CAAC,GAAK,CAAES,KAAM,GAAI,GAAK,CAAEA,KAAM,KAAM,CAACf,EAAG,oBAAoB,CAACM,MAAM,CAAC,MAAQ,OAAO,KAAO,QAAQ,CAACN,EAAG,WAAW,CAACM,MAAM,CAAC,YAAc,SAASU,GAAG,CAAC,OAASpB,EAAIqB,YAAYR,MAAM,CAACC,MAAOd,EAAIW,QAAW,IAAEI,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIW,QAAS,MAAOK,IAAME,WAAW,gBAAgBlB,EAAIsB,GAAItB,EAAY,UAAE,SAASuB,GAAM,OAAOnB,EAAG,kBAAkB,CAACoB,IAAID,EAAKE,GAAGf,MAAM,CAAC,MAAQa,EAAKE,KAAK,CAACzB,EAAIM,GAAG,IAAIN,EAAIO,GAAGgB,EAAKG,MAAM,UAAS,IAAI,IAAI,IAAI,GAAGtB,EAAG,QAAQ,CAACM,MAAM,CAAC,OAAS,KAAK,CAACN,EAAG,QAAQ,CAACM,MAAM,CAAC,KAAO,KAAK,CAACN,EAAG,oBAAoB,CAACM,MAAM,CAAC,MAAQ,OAAO,KAAO,SAAS,CAACN,EAAG,UAAU,CAACM,MAAM,CAAC,KAAO,YAAYG,MAAM,CAACC,MAAOd,EAAIW,QAAY,KAAEI,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIW,QAAS,OAAQK,IAAME,WAAW,mBAAmB,IAAI,IAAI,GAAGd,EAAG,oBAAoB,CAACM,MAAM,CAAC,MAAQ,QAAQ,KAAO,QAAQ,CAACN,EAAG,WAAW,CAACM,MAAM,CAAC,YAAY,UAAU,KAAO,OAAO,OAASV,EAAI2B,MAAM,QAAU3B,EAAI4B,SAASR,GAAG,CAAC,OAASpB,EAAI6B,WAAW,CAACzB,EAAG,WAAW,CAACA,EAAG,SAAS,CAACM,MAAM,CAAC,KAAO,YAAYV,EAAIM,GAAG,aAAa,IAAI,GAAGF,EAAG,MAAM,CAACM,MAAM,CAAC,IAAM,kBAAkB,GAAGN,EAAG,oBAAoB,CAACM,MAAM,CAAC,MAAQ,SAAS,CAACN,EAAG,eAAe,CAACK,IAAI,KAAKW,GAAG,CAAC,OAASpB,EAAI8B,SAASjB,MAAM,CAACC,MAAOd,EAAIW,QAAe,QAAEI,SAAS,SAAUC,GAAMhB,EAAIiB,KAAKjB,EAAIW,QAAS,UAAWK,IAAME,WAAW,sBAAsB,GAAGd,EAAG,oBAAoB,CAAC2B,YAAY,OAAO,CAAC3B,EAAG,WAAW,CAAC4B,YAAY,CAAC,eAAe,QAAQtB,MAAM,CAAC,KAAO,UAAUU,GAAG,CAAC,MAAQpB,EAAIiC,YAAY,CAACjC,EAAIM,GAAG,SAAS,IAAI,IAAI,IAAI,IAC3hE4B,EAAkB,G,mECqDtB,GACEC,KADF,WAEI,MAAO,CACLxB,QAAS,CACPc,GAAI,EACJW,MAAO,GACPC,SAAKC,EACLC,KAAM,GACNC,QAAS,GACTC,IAAK,IAEPjC,KAAK,EACLkC,aAAc,QACdC,SAAU,GACVf,QAAS,GACTD,MAAO,EAAb,cACMiB,MAAO,UAAb,+CACMhC,aAAc,CACZwB,MAAO,CAAC,CAAhB,iDACQC,IAAK,CAAC,CAAd,iDACQE,KAAM,CACd,CAAU,UAAV,EAAU,QAAV,UAAU,QAAV,UACA,CAAU,IAAV,IAAU,QAAV,eAAU,QAAV,cAKEM,QA3BF,WA4BI5C,KAAK6C,cACL7C,KAAKO,IAAMuC,OAAOC,KAAK/C,KAAKgD,OAAOC,QAAQC,QAAQ,MAAQ,EAC3DlD,KAAK2B,QAAU,CAAnB,0BACQ3B,KAAKgD,OAAOC,OAAOzB,IACrBxB,KAAKmD,WAAWnD,KAAKgD,OAAOC,OAAOzB,KAGvC4B,QAAS,CACPhC,WADJ,SACA,GACMpB,KAAKU,QAAQ0B,IAAMvB,GAGrB,QALJ,SAKA,qKACA,aAEA,eACA,mBACA,KACA,oBACA,cACA,OACA,SACA,qCACA,yBAEA,kBAOA,4BApBA,8CAwBI,WA7BJ,SA6BA,mLACA,8BADA,gBACA,EADA,EACA,KACA,iBACA,qEACA,8BACA,0BAEA,6BAEA,iBACA,uBAVA,8CAaI,YA1CJ,WA0CA,gLACA,qBADA,gBACA,EADA,EACA,KACA,iBACA,qEACA,8BACA,0BAEA,6BAEA,kBATA,8CAWImB,UArDJ,WAqDA,WACMhC,KAAKqD,MAAMC,WAAWC,SAA5B,iKACA,EADA,yCACA,wCADA,WAGA,MAHA,gCAGA,kCAHA,OAGA,EAHA,+CAIA,yDAJA,QAIA,EAJA,kBAKA,eALA,0CAKA,6BALA,QAMA,iCACA,6BAPA,oGAWI3B,SAjEJ,SAiEA,GACM,GAAyB,SAArB4B,EAAKC,KAAKC,OAAmB,CAC/B,IAAR,yBACQ,GAAU,OAANC,GAAoB,OAANA,GAAoB,OAANA,GAAoB,OAANA,EAAY,OAAO3D,KAAK4D,SAASC,MAAML,EAAKC,KAAKK,SAASC,SACxG/D,KAAK4D,SAASI,QAAQ,UACtBhE,KAAKU,QAAQ8B,IAAMgB,EAAKC,KAAKK,SAASG,QAC9C,yBACQjE,KAAK4D,SAASC,MAAM,aCjKmU,I,YCO3VK,EAAY,eACd,EACApE,EACAmC,GACA,EACA,KACA,KACA,MAIa,aAAAiC,E,8BClBf,IAAIC,EAAI,EAAQ,QACZC,EAAW,EAAQ,QACnBC,EAAa,EAAQ,QACrBC,EAAQ,EAAQ,QAEhBC,EAAsBD,GAAM,WAAcD,EAAW,MAIzDF,EAAE,CAAEK,OAAQ,SAAUC,MAAM,EAAMC,OAAQH,GAAuB,CAC/DxB,KAAM,SAAc4B,GAClB,OAAON,EAAWD,EAASO","file":"js/AddArt.954808a8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h3',[_vm._v(_vm._s(_vm.Add ? '新建文章' : '编辑文章'))]),_c('a-card',[_c('a-form-model',{ref:\"artInfoRef\",attrs:{\"model\":_vm.artInfo,\"rules\":_vm.artInfoRules}},[_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{attrs:{\"span\":16}},[_c('a-form-model-item',{attrs:{\"label\":\"文章标题\",\"prop\":\"title\"}},[_c('a-input',{model:{value:(_vm.artInfo.title),callback:function ($$v) {_vm.$set(_vm.artInfo, \"title\", $$v)},expression:\"artInfo.title\"}})],1)],1)],1),_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{attrs:{\"lg\":{ span: 6 },\"xs\":{ span: 8 }}},[_c('a-form-model-item',{attrs:{\"label\":\"文章分类\",\"prop\":\"cid\"}},[_c('a-select',{attrs:{\"placeholder\":\"请选择分类\"},on:{\"change\":_vm.CateChange},model:{value:(_vm.artInfo.cid),callback:function ($$v) {_vm.$set(_vm.artInfo, \"cid\", $$v)},expression:\"artInfo.cid\"}},_vm._l((_vm.Catelist),function(item){return _c('a-select-option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])}),1)],1)],1)],1),_c('a-row',{attrs:{\"gutter\":16}},[_c('a-col',{attrs:{\"span\":16}},[_c('a-form-model-item',{attrs:{\"label\":\"文章描述\",\"prop\":\"desc\"}},[_c('a-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.artInfo.desc),callback:function ($$v) {_vm.$set(_vm.artInfo, \"desc\", $$v)},expression:\"artInfo.desc\"}})],1)],1)],1),_c('a-form-model-item',{attrs:{\"label\":\"文章缩略图\",\"prop\":\"img\"}},[_c('a-upload',{attrs:{\"list-type\":\"picture\",\"name\":\"file\",\"action\":_vm.upUrl,\"headers\":_vm.headers},on:{\"change\":_vm.upChange}},[_c('a-button',[_c('a-icon',{attrs:{\"type\":\"upload\"}}),_vm._v(\" Upload \")],1)],1),_c('img',{attrs:{\"src\":\"artInfo.img\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"文章内容\"}},[_c('mavon-editor',{ref:\"md\",on:{\"imgAdd\":_vm.$imgAdd},model:{value:(_vm.artInfo.content),callback:function ($$v) {_vm.$set(_vm.artInfo, \"content\", $$v)},expression:\"artInfo.content\"}})],1),_c('a-form-model-item',{staticClass:\"btn\"},[_c('a-button',{staticStyle:{\"margin-right\":\"15px\"},attrs:{\"type\":\"danger\"},on:{\"click\":_vm.submitClk}},[_vm._v(\"提交\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h3>{{ Add ? '新建文章' : '编辑文章' }}</h3>\r\n    <a-card>\r\n      <a-form-model :model=\"artInfo\" ref=\"artInfoRef\" :rules=\"artInfoRules\">\r\n        <a-row :gutter=\"16\">\r\n          <a-col :span=\"16\">\r\n            <a-form-model-item label=\"文章标题\" prop=\"title\">\r\n              <a-input v-model=\"artInfo.title\"></a-input>\r\n            </a-form-model-item>\r\n          </a-col>\r\n        </a-row>\r\n\r\n        <a-row :gutter=\"16\">\r\n          <a-col :lg=\"{ span: 6 }\" :xs=\"{ span: 8 }\">\r\n            <a-form-model-item label=\"文章分类\" prop=\"cid\">\r\n              <a-select v-model=\"artInfo.cid\" @change=\"CateChange\" placeholder=\"请选择分类\">\r\n                <a-select-option v-for=\"item in Catelist\" :key=\"item.id\" :value=\"item.id\">\r\n                  {{ item.name }}\r\n                </a-select-option>\r\n              </a-select>\r\n            </a-form-model-item>\r\n          </a-col>\r\n        </a-row>\r\n\r\n        <a-row :gutter=\"16\">\r\n          <a-col :span=\"16\">\r\n            <a-form-model-item label=\"文章描述\" prop=\"desc\">\r\n              <a-input type=\"textarea\" v-model=\"artInfo.desc\"></a-input>\r\n            </a-form-model-item>\r\n          </a-col>\r\n        </a-row>\r\n\r\n        <a-form-model-item label=\"文章缩略图\" prop=\"img\">\r\n          <a-upload list-type=\"picture\" name=\"file\" :action=\"upUrl\" :headers=\"headers\" @change=\"upChange\">\r\n            <a-button> <a-icon type=\"upload\" /> Upload </a-button>\r\n          </a-upload>\r\n          <img src=\"artInfo.img\" />\r\n        </a-form-model-item>\r\n\r\n        <a-form-model-item label=\"文章内容\">\r\n          <mavon-editor ref=\"md\" v-model=\"artInfo.content\" @imgAdd=\"$imgAdd\"></mavon-editor>\r\n        </a-form-model-item>\r\n        <a-form-model-item class=\"btn\">\r\n          <a-button type=\"danger\" style=\"margin-right:15px\" @click=\"submitClk\">提交</a-button>\r\n        </a-form-model-item>\r\n      </a-form-model>\r\n    </a-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Url } from '../../plugin/http.js'\r\nimport axios from 'axios'\r\nexport default {\r\n  data() {\r\n    return {\r\n      artInfo: {\r\n        id: 0,\r\n        title: '',\r\n        cid: undefined,\r\n        desc: '',\r\n        content: '',\r\n        img: ''\r\n      },\r\n      Add: false,\r\n      CurrCateName: '请选择分类',\r\n      Catelist: [],\r\n      headers: {},\r\n      upUrl: Url + 'upload',\r\n      token: `Bearer ${window.sessionStorage.getItem('token')}`,\r\n      artInfoRules: {\r\n        title: [{ required: true, message: '请输入文章标题', trigger: 'change' }],\r\n        cid: [{ required: true, message: '请选择文章分类', trigger: 'change' }],\r\n        desc: [\r\n          { required: true, message: '请输入文章描述', trigger: 'change' },\r\n          { max: 120, message: '描述最多可写120个字符', trigger: 'change' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getCateList()\r\n    this.Add = Object.keys(this.$route.params).indexOf('id') < 0\r\n    this.headers = { Authorization: this.token }\r\n    if (this.$route.params.id) {\r\n      this.getArtInfo(this.$route.params.id)\r\n    }\r\n  },\r\n  methods: {\r\n    CateChange(value) {\r\n      this.artInfo.cid = value\r\n    },\r\n    // 绑定@imgAdd event\r\n    async $imgAdd(pos, $file) {\r\n      const $vm = this.$refs.md\r\n      // 第一步.将图片上传到服务器.\r\n      var formdata = new FormData()\r\n      formdata.append('file', $file)\r\n      axios({\r\n        url: Url + 'upload',\r\n        method: 'post',\r\n        data: formdata,\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n          Authorization: this.token\r\n        }\r\n      }).then(url => {\r\n        // 第二步.将返回的url替换到文本原位置![...](0) -> ![...](url)\r\n        /**\r\n         * $vm 指为mavonEditor实例，可以通过如下两种方式获取\r\n         * 1. 通过引入对象获取: `import {mavonEditor} from ...` 等方式引入后，`$vm`为`mavonEditor`\r\n         * 2. 通过$refs获取: html声明ref : `<mavon-editor ref=md ></mavon-editor>，`$vm`为 `this.$refs.md`\r\n         */\r\n        $vm.$img2Url(pos, url.data.url)\r\n      })\r\n    },\r\n    // 查询文章信息\r\n    async getArtInfo(id) {\r\n      const { data: res } = await this.$http.get(`art/${id}`)\r\n      if (res.status !== 200) {\r\n        if (res.status === 1004 || res.status === 1005 || res.status === 1006 || res.status === 1007) {\r\n          window.sessionStorage.clear()\r\n          this.$router.push('/login')\r\n        }\r\n        this.$message.error(res.message)\r\n      }\r\n      this.artInfo = res.data\r\n      this.artInfo.id = res.data.ID\r\n    },\r\n    // 获取分类列表\r\n    async getCateList() {\r\n      const { data: res } = await this.$http.get('cates')\r\n      if (res.status !== 200) {\r\n        if (res.status === 1004 || res.status === 1005 || res.status === 1006 || res.status === 1007) {\r\n          window.sessionStorage.clear()\r\n          this.$router.push('/login')\r\n        }\r\n        this.$message.error(res.message)\r\n      }\r\n      this.Catelist = res.data\r\n    },\r\n    submitClk() {\r\n      this.$refs.artInfoRef.validate(async valid => {\r\n        if (!valid) return this.$message.error('参数验证未通过，请按要求录入文章内容')\r\n        let res\r\n        if (this.Add) res = await this.$http.post('art/add', this.artInfo)\r\n        else res = await this.$http.put(`art/${this.$route.params.id}`, this.artInfo)\r\n        if (res.status !== 200) return this.$message.error(res.message)\r\n        this.$router.push('/admin/artlist')\r\n        this.$message.success('添加文章成功')\r\n      })\r\n    },\r\n    // 上传图片\r\n    upChange(info) {\r\n      if (info.file.status === 'done') {\r\n        let s = info.file.response.status\r\n        if (s === 1004 || s === 1005 || s === 1006 || s === 1007) return this.$message.error(info.file.response.message)\r\n        this.$message.success(`图片上传成功`)\r\n        this.artInfo.img = info.file.response.url\r\n      } else if (info.file.status === 'error') {\r\n        this.$message.error(`图片上传失败`)\r\n      }\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddArt.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddArt.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AddArt.vue?vue&type=template&id=37f2dd5c&\"\nimport script from \"./AddArt.vue?vue&type=script&lang=js&\"\nexport * from \"./AddArt.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n"],"sourceRoot":""}